[buildout]

extends =
  ../../stack/lapp/buildout.cfg

# += since we need rdiff-backup and friends
parts +=
  slapos-cookbook
  apache-php-postgres
  pear-modules
  eggs
  instance
  instance-apache-php

#----------------
#--
#-- Main application part
#-- XXX provide a better URL

[application]
url = http://downloads.sourceforge.net/project/maarch/Maarch%20Entreprise/MaarchEntreprise-1.3.zip?r=http%3A%2F%2Fwww.maarch.org%2Ftelecharger&ts=1347961624&use_mirror=ignum
md5sum = 5c2c859dee9d0dde3ba959474fd5fc86


#----------------
#--
#-- We don't need this static configuration file.
#-- An empty file is provided because it is required by the lapp stack.
#--

[application-template]
recipe = slapos.recipe.download
url = ${:_profile_base_location_}/config.php.in
md5sum = d41d8cd98f00b204e9800998ecf8427e
download-only = True
filename = template.in
mode = 0644
location = ${buildout:parts-directory}/${:_buildout_section_name_}

[application-configuration]
location = config.php


#----------------
#--
#-- Define parts that will be executed later, in the instance.
#--

[custom-application-deployment]
path = ${custom-application-deployment-template:output}
part-list = maarch-configuration

[custom-application-deployment-template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-custom.cfg.in
output = ${buildout:directory}/instance-custom.cfg
md5sum = 28f6ad42b73806901ac2cd4ec563d73b
mode = 0644


#----------------
#--
#-- Install PHP channels and modules (only if they are not already installed).
#--

[pear-modules]
recipe = cp.recipe.cmd
pear = ${apache-php-postgres:location}/bin/pear
install_cmd =
    ${:pear} channel-info pear.maarch.org >/dev/null || ${:pear} channel-discover pear.maarch.org
    ${:pear} info maarch/CLITools-0.3.1 >/dev/null || ${:pear} install maarch/CLITools-0.3.1
    ${:pear} info MIME_Type >/dev/null || ${:pear} install MIME_Type


#----------------

[versions]
Jinja2 = 2.6
Werkzeug = 0.8.3
apache-libcloud = 0.11.4
async = 0.6.1
buildout-versions = 1.7
cns.recipe.symlink = 0.2.3
gitdb = 0.5.4
hexagonit.recipe.cmmi = 1.6
inotifyx = 0.2.0
lxml = 3.0.2
netaddr = 0.7.10
psycopg2 = 2.4.6
pycrypto = 2.6
pytz = 2012h
rdiff-backup = 1.0.5
slapos.recipe.download = 1.0.dev-r4053
slapos.recipe.template = 2.4.2
smmap = 0.8.2

# Required by:
# slapos.core==0.33.2-dev
# slapos.toolbox==0.32.1-dev
Flask = 0.9

# Required by:
# slapos.toolbox==0.32.1-dev
GitPython = 0.3.2.RC1

# Required by:
# slapos.toolbox==0.32.1-dev
atomize = 0.1.1

# Required by:
# slapos.toolbox==0.32.1-dev
feedparser = 5.1.3

# Required by:
# hexagonit.recipe.cmmi==1.6
hexagonit.recipe.download = 1.6

# Required by:
# slapos.core==0.33.2-dev
netifaces = 0.8

# Required by:
# slapos.toolbox==0.32.1-dev
paramiko = 1.9.0

# Required by:
# slapos.toolbox==0.32.1-dev
psutil = 0.6.1

# Required by:
# slapos.core==0.33.2-dev
pyflakes = 0.5.0

# Required by:
# cns.recipe.symlink==0.2.3
# slapos.cookbook==0.70.1-dev
# slapos.core==0.33.2-dev
# slapos.toolbox==0.32.1-dev
# supervisor==3.0b1
# zc.buildout==1.6.0-dev-SlapOS-010
# zope.interface==4.0.2
setuptools = 0.6c12dev-r88846

# Required by:
# slapos.core==0.33.2-dev
supervisor = 3.0b1

# Required by:
# slapos.toolbox==0.32.1-dev
xml-marshaller = 0.9.7

# Required by:
# slapos.core==0.33.2-dev
zope.interface = 4.0.2

