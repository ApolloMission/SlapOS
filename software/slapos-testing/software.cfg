
[buildout]
extends = ../../stack/slapos.cfg
          ../../component/git/buildout.cfg

parts = runTestSuite
        slapos.core-repository
        slapos.recipe.template-repository
        template

develop = ${buildout:parts-directory}/parts/erp5.util-repository
          ${buildout:parts-directory}/parts/erp5.cookbook-repository
   

[erp5.util-repository]
<= download-source
repository = http://git.erp5.org/repos/erp5.git
branch = for_test_runner_1

[erp5.cookbook-repository]
<= download-source
repository = http://git.erp5.org/repos/slapos.git
branch = slapos-testing

[runTestSuite]
recipe = zc.recipe.egg

eggs = 
   erp5.util

entry-points =
  runTestSuite=erp5.util.testsuite:runTestSuite

scripts = 
  runTestSuite

[download-source]
recipe = plone.recipe.command
location = ${buildout:parts-directory}/${:_buildout_section_name_}
stop-on-error = true
branch = master
revision =
command = "${git:location}/bin/git" clone --quiet --branch "${:branch}" "${:repository}" "${:location}" && if [ -n "${:revision}" ]; then cd "${:location}" && "${git:location}/bin/git" reset --quiet --hard "${:revision}" ; fi
update-command = cd "${:location}" && "${git:location}/bin/git" fetch && if [ -n "${:revision}" ]; then "${git:location}/bin/git" reset --hard "${:revision}"; else "${git:location}/bin/git" reset --hard @{upstream} ; fi

[slapos.core-repository]
<= download-source
repository = http://git.erp5.org/repos/slapos.core.git

[slapos.recipe.template-repository]
<= download-source
repository = http://git.erp5.org/repos/slapos.recipe.template.git

[template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance.cfg
md5sum = 1382838589e31ebfcba4420d9c7d42d9
output =  ${buildout:directory}/template.cfg
mode = 640
