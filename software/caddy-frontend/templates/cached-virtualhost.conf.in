{% set TRUE_VALUES = ['y', 'yes', '1', 'true'] -%}
{% set server_alias_list =  slave_parameter.get('server-alias', '').split() %}
{% set ssl_proxy_verify = ('' ~ slave_parameter.get('ssl-proxy-verify', '')).lower() in TRUE_VALUES -%}

# TODO-Caddy # Only accept generic (i.e not Zope) backends on http
# TODO-Caddy <VirtualHost *:{{ cached_port }}>
# TODO-Caddy   ServerName {{ slave_parameter.get('custom_domain') }}
# TODO-Caddy   {%- for server_alias in server_alias_list %}
# TODO-Caddy   ServerAlias {{ server_alias }}
# TODO-Caddy   {% endfor %}
# TODO-Caddy   SSLProxyEngine on

# TODO-Caddy {% if ssl_proxy_verify -%}
# TODO-Caddy {%   if 'ssl_proxy_ca_crt' in slave_parameter -%}
# TODO-Caddy   SSLProxyCACertificateFile {{ slave_parameter.get('path_to_ssl_proxy_ca_crt', '') }}
# TODO-Caddy {%   endif %}
# TODO-Caddy   SSLProxyVerify require
# TODO-Caddy   #SSLProxyCheckPeerCN on
# TODO-Caddy   SSLProxyCheckPeerExpire on
# TODO-Caddy {% endif %}
# TODO-Caddy   # Rewrite part
# TODO-Caddy   ProxyPreserveHost On
# TODO-Caddy   ProxyTimeout 600
# TODO-Caddy   RewriteEngine On
# TODO-Caddy 
# TODO-Caddy   RewriteRule ^/(.*)$ {{ slave_parameter.get('backend_url', '') }}/$1 [L,P]
# TODO-Caddy </VirtualHost>

# TODO-Caddy <VirtualHost *:{{ ssl_cached_port }}>
# TODO-Caddy   ServerName {{ slave_parameter.get('custom_domain') }}
# TODO-Caddy   {%- for server_alias in server_alias_list %}
# TODO-Caddy   ServerAlias {{ server_alias }}
# TODO-Caddy   {% endfor %}
# TODO-Caddy   SSLProxyEngine on
# TODO-Caddy 
# TODO-Caddy {% if ssl_proxy_verify -%}
# TODO-Caddy {%   if 'ssl_proxy_ca_crt' in slave_parameter -%}
# TODO-Caddy   SSLProxyCACertificateFile {{ slave_parameter.get('path_to_ssl_proxy_ca_crt', '') }}
# TODO-Caddy {%   endif %}
# TODO-Caddy   SSLProxyVerify require
# TODO-Caddy   #SSLProxyCheckPeerCN on
# TODO-Caddy   SSLProxyCheckPeerExpire on
# TODO-Caddy {% endif %}
# TODO-Caddy   # Rewrite part
# TODO-Caddy   ProxyPreserveHost On
# TODO-Caddy   ProxyTimeout 600
# TODO-Caddy   RewriteEngine On
# TODO-Caddy 
# TODO-Caddy   RewriteRule ^/(.*)$ {{ slave_parameter.get('https_backend_url', '') }}/$1 [L,P]
# TODO-Caddy </VirtualHost>
# TODO-Caddy 
