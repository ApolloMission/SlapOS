[buildout]

extends =
  ../../component/zabbix/buildout.cfg
  ../../stack/slapos.cfg
  ../../stack/lamp/buildout.cfg

parts +=
  slapos-cookbook
  zabbix-server
  apache-php
  instance-apache-php

[zabbix-instances]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-zabbix.cfg.in
output = ${buildout:directory}/custom-apache-php.cfg
#md5sum = 3e2d71d3684aac3e52d2f55794df96bf
mode = 0644

[custom-application-deployment]
path = ${zabbix-instances:output}
part-list = install-zabbix-db

[application]
recipe = plone.recipe.command
command = echo "I've already downloaded package"
update-command = 
location = ${zabbix-server:compile-directory}/zabbix-${zabbix-server:version}/frontends/php

[download-base]
recipe = slapos.recipe.download
location = ${buildout:parts-directory}/${:_buildout_section_name_}
mode = 0644
url = ${:_profile_base_location_}/${:filename}

[application-template]
<= download-base
#md5sum = Student may put here md5sum of this file, this is good idea
filename = zabbix.conf.php.in

[template-zabbix-conf]
<= download-base
#md5sum = Student may put here md5sum of this file, this is good idea
filename = zabbix_server.conf.in

[template-httpd-conf]
<= download-base
#md5sum = Student may put here md5sum of this file, this is good idea
filename = apache.conf.in

[template-zabbix-database]
<= download-base
#md5sum = Student may put here md5sum of this file, this is good idea
filename = database.sh.in

[zabbix-svcdeamon]
<= download-base
#md5sum = Student may put here md5sum of this file, this is good idea
url = ${:_profile_base_location_}/scripts/${:filename}
filename = svcdaemon.py

[application-configuration]
location = conf/zabbix.conf.php

