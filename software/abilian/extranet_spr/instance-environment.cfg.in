[buildout]

parts =
    sh-instance-environment


[instance-environment]
UNO_PATH=${libreoffice-bin:location}/program
PGDATA=$${postgres-instance:pgdata-directory}
PGHOST=$${:PGDATA}
PGUSER=postgres
ABILIAN_CONFIG=${abilian-config:location}/${abilian-config:filename}
EXTRANET_INSTANCE_PATH=$${directories:extranet_spr-instance}
EXTRANET_INSTANCE_HOST=$${instance-parameters:ipv6-random}
ABILIAN_CONFIG_EXTRA_PYTHON=$${config-staging-py:rendered}
ABILIAN_CONFIG_EXTRA_JSON=$${json-extra-configuration:json-output}:$${buildout:directory}/partition-parameters.json
LD_LIBRARY_PATH=${cairo:location}/lib:${glib:location}/lib:${pango:location}/lib
# abilian/services/conversion.py does not like it, if PATH does not exist
PATH=/usr/sbin:/usr/bin:/sbin:/bin:${git:location}/bin:${poppler:location}/bin:${postgresql91:location}/bin:${redis:location}/bin:${unoconv-repository:location}



[sh-instance-environment]
recipe = collective.recipe.template
inline =
    export UNO_PATH=$${instance-environment:UNO_PATH}
    export PGDATA=$${instance-environment:PGDATA}
    export PGHOST=$${instance-environment:PGHOST}
    export PGUSER=$${instance-environment:PGUSER}
    export ABILIAN_CONFIG=$${instance-environment:ABILIAN_CONFIG}
    export EXTRANET_INSTANCE_PATH=$${instance-environment:EXTRANET_INSTANCE_PATH}
    export EXTRANET_INSTANCE_HOST=$${instance-environment:EXTRANET_INSTANCE_HOST}
    export ABILIAN_CONFIG_EXTRA_PYTHON=$${instance-environment:ABILIAN_CONFIG_EXTRA_PYTHON}
    export ABILIAN_CONFIG_EXTRA_JSON=$${instance-environment:ABILIAN_CONFIG_EXTRA_JSON}
    export LD_LIBRARY_PATH=$${instance-environment:LD_LIBRARY_PATH}
    export PATH=$${instance-environment:PATH}
output = $${buildout:directory}/environment.sh


