[buildout]
extends = {{ template_erp5_cluster }}
parts =
  switch-softwaretype

eggs-directory = {{ eggs_directory }}
develop-eggs-directory ={{  develop_eggs_directory }}
offline = true

[dynamic-template-notebook-parameters]
bin_directory = {{ bin_directory }}
develop_eggs_directory = {{ develop_eggs_directory }}
eggs_directory = {{ eggs_directory }}
openssl_output = {{ openssl_output }}
ipython_notebook_config_location = {{ ipython_notebook_config_location }}
ipython_notebook_config_filename = {{ ipython_notebook_config_filename }}
ipython_notebook_set_password_location = {{ ipython_notebook_set_password_location }}
ipython_notebook_set_password_filename = {{ ipython_notebook_set_password_filename }}
erp5_kernel_location = {{ erp5_kernel_location }}
erp5_kernel_filename = {{ erp5_kernel_filename }}
kernel_json_location = {{ kernel_json_location }}
kernel_json_filename = {{ kernel_json_filename }}
monitor-template = {{ monitor_template }}
custom_js_location = {{ custom_js_location }}
custom_js_filename = {{ custom_js_filename }}

[dynamic-template-notebook]
< = jinja2-template-base
template = {{ template_notebook }}
filename = instance-notebook.cfg
extensions = jinja2.ext.do
extra-context = 
  section parameter_dict dynamic-template-notebook-parameters

[dynamic-template-default-parameters]
instance-erp5-site = ${dynamic-template-create-erp5-site:rendered}
eggs_directory = {{ eggs_directory }}
develop_eggs_directory = {{ develop_eggs_directory }}

[dynamic-template-default]
< = jinja2-template-base
template = {{template_default}}
filename = instance-default.cfg
extensions = jinja2.ext.do
extra-context =
  import json_module json
  raw template_publish_information {{ template_publish_information }}
  key slap_software_type slap-configuration:slap-software-type
  section parameter_dict dynamic-template-default-parameters

[switch-softwaretype]
recipe = slapos.cookbook:switch-softwaretype
default = dynamic-template-default:rendered
create-erp5-site = dynamic-template-default:rendered
notebook = dynamic-template-notebook:rendered
erp5-cluster-create-erp5-site = dynamic-template-create-erp5-site:rendered
erp5-cluster-default = dynamic-template-erp5:rendered
