[buildout]
extends =
  ../../stack/tomcat.cfg
  ../../stack/slapos.cfg
  ../../component/gperf/buildout.cfg
  ../../component/boost-lib/buildout.cfg
  ../../component/subversion/buildout.cfg

parts += palo

[instance-recipe]
egg = slapos.cookbook
module = palo

[instance-recipe-egg]
recipe = zc.recipe.egg
eggs = ${instance-recipe:egg}

[template]
# Default template for the instance.
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance.cfg
md5sum = dbdc297502f0258c85fe7dfbddc8e501
output = ${buildout:directory}/template.cfg
mode = 0644

[palo_olap_checkout]
recipe = infrae.subversion
urls = https://palo.svn.sourceforge.net/svnroot/palo/molap/server/3.X/Source palo_olap
; known good revision: 456

[palo]
recipe = hexagonit.recipe.cmmi
;path = ${palo_olap_checkout:location}/palo_olap
path = /home/jerome/src/palo_olap
; XXX in svn repo, configure is not exectuable
configure-command = chmod +x ./configure && ./configure --prefix=${buildout:parts-directory}/${:_buildout_section_name_}/
#; patch to actually install palo binary
#patches = ${buildout:directory}/patches/palo_olap_install_palo.diff
#patch-options = -p0

environment =
  CPPFLAGS=-I${gperf:location}/include -I${boost-lib:location}/include
  LDFLAGS=-L${gperf:location}/lib -Wl,-rpath=${gperf:location}/lib -L${boost-lib:location}/lib -Wl,-rpath=${boost-lib:location}/lib 
  PATH=${gperf:location}/bin:%(PATH)s

[versions]
