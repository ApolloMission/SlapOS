[buildout]
parts =  
  boinc-client
  tunnel-ipv6-http
  publish-connection-informations

eggs-directory = ${buildout:eggs-directory}
develop-eggs-directory = ${buildout:develop-eggs-directory}
offline = true

[rootdirectory]
recipe = slapos.cookbook:mkdirectory
etc = $${buildout:directory}/etc/
var = $${buildout:directory}/var/
srv = $${buildout:directory}/srv/
bin = $${buildout:directory}/bin/
tmp = $${buildout:directory}/tmp/

[basedirectory]
recipe = slapos.cookbook:mkdirectory
log = $${rootdirectory:var}/log/
services = $${rootdirectory:etc}/service
scripts = $${rootdirectory:etc}/run
run = $${rootdirectory:var}/run/
backup = $${rootdirectory:srv}/backup/
promises = $${rootdirectory:etc}/promise/
boinc = $${rootdirectory:srv}/boinc/

[boinc-passwd]
recipe = slapos.cookbook:generate.password
storage-path = $${basedirectory:boinc}/gui_rpc_auth.cfg
bytes = 8

[boinc-client]
recipe = slapos.cookbook:boinc.client
install-dir = $${basedirectory:boinc}
home = $${buildout:directory}
client-wrapper = $${basedirectory:services}/boinc_client
cmd-wrapper = $${basedirectory:scripts}/boinc_cmd
ip = $${slap-network-information:global-ipv6}
passwd = $${boinc-passwd:passwd}
#specifie a cc_config.xml file to boinc client, use cconfig
cconfig =
boinc-bin = ${boinc:location}/bin/boinc_client
cmd-bin = ${boinc:location}/bin/boinccmd
project-url = $${slap-parameter:boinc-project-url}
local-ipv4 = $${slap-network-information:local-ipv4}
key = $${slap-parameter:boinc-account-key}
tunnel-wapper = $${basedirectory:services}/6tunnel-http

[tunnel-ipv6-http]
recipe = slapos.cookbook:ipv4toipv6
ipv6 = $${boinc-client:project-host}
ipv6-port = $${boinc-client:project-port}
ipv4 = $${slap-network-information:local-ipv4}
ipv4-port = $${boinc-client:project-port}
shell-path = ${dash:location}/bin/dash
6tunnel-path = ${6tunnel:location}/bin/6tunnel
runner-path = $${boinc-client:tunnel-wapper}


# Publish all instance parameters
[publish-connection-informations]
recipe = slapos.cookbook:publish
boinc_project_url = $${slap-parameter:boinc-project-url}
boinc_account_key = $${slap-parameter:boinc-account-key}
remote_host = $${boinc-client:ip}
rpc_port = $${boinc-client:rpc-port}
rpc_passwd = $${boinc-passwd:passwd}

[slap-parameter]
#please provide project_url and your session key via SlapOS Master (instance parameters)
boinc-project-url = 
boinc-account-key = 
