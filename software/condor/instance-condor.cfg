[buildout]
parts =
  condor

eggs-directory = ${buildout:eggs-directory}
develop-eggs-directory = ${buildout:develop-eggs-directory}
offline = true

# Create all needed directories
[rootdirectory]
recipe = slapos.cookbook:mkdirectory
etc = $${buildout:directory}/etc/
var = $${buildout:directory}/var/
condor = $${buildout:directory}/condor/
bin = $${buildout:directory}/bin/
sbin = $${buildout:directory}/sbin/
srv = $${buildout:directory}/srv/

[basedirectory]
recipe = slapos.cookbook:mkdirectory
log = $${rootdirectory:var}/log/
services = $${rootdirectory:etc}/run/
run = $${rootdirectory:var}/run/
backup = $${rootdirectory:srv}/backup/
promises = $${rootdirectory:etc}/promise/

[wrapperdirectory]
recipe = slapos.cookbook:mkdirectory
wrapper = $${basedirectory:run}/condor

[condor]
recipe = slapos.cookbook:condor
config_wrapper = $${basedirectory:services}/configure
ip = $${slap-network-information:global-ipv6}
package = ${condor:location}
rootdirectory = $${buildout:directory}
local-dir = $${rootdirectory:condor}
perl-bin = ${perl:location}/bin
java-bin = ${java:location}/bin
bin = $${wrapperdirectory:wrapper}/bin/
sbin = $${wrapperdirectory:wrapper}/sbin/
#additionnal LD_LIBRARY_PATH and PATH for all condor executable files
linkdir = ${libexpat:location}/lib:${kerberos:location}/lib:${openldap:location}/lib:${zlib:location}/lib
path = ${perl:location}/bin:${java:location}/bin:${kerberos:location}/bin:${openldap:location}/bin:$PATH
dash = ${dash:location}/bin/dash

#Condor user parameter
condor_host = $${slap-parameter:host_manager_name}
domain = $${slap-parameter:domain}
collector_name = $${slap-parameter:collector_name}
#Condor machine role: worker=submit,execute manager=manager,submit
machine-role = $${slap-parameter:role}
disk-space = $${slap-parameter:diskspace}

[slap-parameter]
# Default values if not specified
host_manager_name = [$${slap-network-information:global-ipv6}]
domain = *
collector_name = SLAPOS-CONDOR-POOL
role = worker
diskspace = 5