[buildout]
extends =
  ../../component/mariadb/buildout.cfg
  ../../component/apache/buildout.cfg
  ../../component/apache-php/buildout.cfg

parts =
  apache-php
  wordpress
  template
  configure-files
prefix = ${buildout:directory}

find-links =
  http://www.nexedi.org/static/packages/source/slapos.buildout/
versions = versions

[versions]
zc.buildout = 1.6.0-dev-SlapOS-010

[wordpress]
recipe = slapos.recipe.cmmi
prefix = ${buildout:parts-directory}/${:_buildout_section_name_}
url = http://wordpress.org/wordpress-3.4.2.tar.gz
md5sum = dfc56cee27eec8fb79070f033ecd4b25
configure-command = true
make-binary = true
post-install = cp -a * ${:prefix}/

[x86-cygwin-wordpress]
patch-options = -p1
patches = ${:_profile_base_location_}/wordpress-3.4.2-mysqli.patch
post-install =
  ${wordpress:post-install}
  ls -1 -d ${buildout:directory}/bin/*.dll > /rebase.filelist
  ls -1 -d ${apache:prefix}/modules/*.so >> /rebase.filelist

[template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/template.cfg.in
md5sum = 2dc4b12c8ebe270516f6d02032f93071
output = ${buildout:directory}/template.cfg
mode = 0644

[configure-files]
recipe = hexagonit.recipe.download
url = ${:_profile_base_location_}/configure-files.tar.gz
md5sum = 46f39abe6c7245fe7b30805b68b0d937

