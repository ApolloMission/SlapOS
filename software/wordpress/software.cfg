[buildout]
versions = versions  
extends =
  ../../component/nginx/buildout.cfg
  ../../stack/lamp/buildout.cfg
  ../../stack/shacache-client.cfg

parts =
  nginx-php
  mariadb
  mydumper
  mysql-python
  rdiff-backup
  dropbear
  eggs
  instance-recipe-egg
  template
  template-apache-php
  template-mariadb
  template-mariadb-pbsready
  template-mariadb-pbsready-import
  template-mariadb-pbsready-export
  nginx
  slapos.cookbook-repository
  check-recipe

# Local development
develop =
  ${:parts-directory}/slapos.cookbook-repository

# Local development
[slapos.cookbook-repository]
recipe = plone.recipe.command
stop-on-error = true
location = ${buildout:parts-directory}/${:_buildout_section_name_}
command = ${git:location}/bin/git clone --branch wordpress-nginx --quiet http://git.erp5.org/repos/slapos.git ${:location}
update-command = cd ${:location} && GIT_COMMITTER_EMAIL=nobody@example.com GIT_AUTHOR_NAME=Nobody GIT_AUTHOR_EMAIL=nobody@example.com ${git:location}/bin/git pull --quiet

[check-recipe]
recipe = plone.recipe.command
stop-on-error = true
update-command = ${:command}
command = grep parts ${buildout:develop-eggs-directory}/slapos.cookbook.egg-link


# Overwrite with local to use nginx instead apache.
[template-apache-php]
url = ${:_profile_base_location_}/instance-apache-php.cfg
md5sum = 8273d47818a3139f6d43b949f3ec4cf2 

[application]
url = http://wordpress.org/latest.tar.gz
#md5sum = Student may put here md5sum of this file, this is good idea

[application-template]
recipe = slapos.recipe.download
url = ${:_profile_base_location_}/wp-config.php.in
md5sum = 0d62b28125ca3c780db0b547199953f2
download-only = True
filename = template.in
mode = 0644
location = ${buildout:parts-directory}/${:_buildout_section_name_}

[application-configuration]
location = wp-config.php

[networkcache]
# signature certificates of the following uploaders.
#   Florian Bourse
signature-certificate-list =
  -----BEGIN CERTIFICATE-----
  MIIB9jCCAV+gAwIBAgIJAOFuiV6qgvciMA0GCSqGSIb3DQEBBQUAMBMxETAPBgNV
  BAMMCENPTVAtNjcxMCAXDTEyMDYyNTA5MzcyMloYDzIxMTIwNjAxMDkzNzIyWjAT
  MREwDwYDVQQDDAhDT01QLTY3MTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA
  vrFpin2TYN0MA60EdolYQdZTybnbzcWnTqhoo7/SBnd/q/58Fq3DcvQFrzLeHwFC
  FoqN58evkLZdeZ3Cy7WP/d7DvkR+WVFQstm19N5zNfgAcU9FMVDI1xCHBPjZNNAc
  yOdnMn0XKjek7RmNTCpMwB2KuAK6BcWihqrtnQDbyfMCAwEAAaNQME4wHQYDVR0O
  BBYEFLmeCKE/BbNBOPnZP/EFGZg+MLP0MB8GA1UdIwQYMBaAFLmeCKE/BbNBOPnZ
  P/EFGZg+MLP0MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADgYEAJ4bPas0H
  DpyeGf+OETMlC73nMxN6PBFCZ3mKQrV/Bg+DpzTXVD5UgtjOdnrNQGZtUX6S7HQd
  sEraQ2s/Nj9ggpFCIurSyXnOxLbJHs42X+cKmrbYT0TA2xF+V9ufd+l3A3OHA8Vk
  7iIzq0yQYwPwx9U1pFwUroQnrVqky3nlff8=
  -----END CERTIFICATE-----

