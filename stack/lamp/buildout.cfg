[buildout]
find-links +=
    http://www.nexedi.org/static/packages/source/slapos.buildout/

parts =
  apache-php
  mariadb
  mydumper
  mysql-python
  rdiff-backup
  dropbear
  eggs
  instance-recipe-egg
  template
  template-apache-php
  template-mariadb
  template-mariadb-pbsready
  template-mariadb-pbsready-import
  template-mariadb-pbsready-export

allow-hosts =
  *.nexedi.org
  *.python.org
  *.sourceforge.net
  alastairs-place.net
  dist.repoze.org
  effbot.org
  github.com
  peak.telecommunity.com
  psutil.googlecode.com
  www.dabeaz.com
  launchpad.net

extends =
  ../shacache-client.cfg
  ../../component/mariadb/buildout.cfg
  ../../component/apache/buildout.cfg
  ../../component/apache-php/buildout.cfg
  ../../component/dcron/buildout.cfg
  ../../component/git/buildout.cfg
  ../../component/glib/buildout.cfg
  ../../component/logrotate/buildout.cfg
  ../../component/python-2.7/buildout.cfg
  ../../component/perl/buildout.cfg
  ../../component/sqlite3/buildout.cfg
  ../../component/lxml-python/buildout.cfg
  ../../component/zlib/buildout.cfg
  ../../component/rdiff-backup/buildout.cfg
  ../../component/gzip/buildout.cfg
  ../../component/stunnel/buildout.cfg
  ../../component/mydumper/buildout.cfg
  ../../component/mysql-python/buildout.cfg
  ../../component/dropbear/buildout.cfg
  ../../component/gunicorn/buildout.cfg

versions = versions

[mariadb]
# Compile dir is for plugins, there's no plugin in LAMP
keep-compile-dir = false

[instance-recipe]
egg = slapos.cookbook
module = lamp.request

[instance-recipe-egg]
recipe = zc.recipe.egg
#python = python2.7
eggs = ${instance-recipe:egg}

[application]
recipe = hexagonit.recipe.download
#If provided tarball does not containt top directory this option shall be changed to false
strip-top-level-dir = true

[template]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance.cfg
output = ${buildout:directory}/template.cfg
md5sum = bcb2af107e4063c03f4cfff4add54410
mode = 0644

[template-down]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-down.cfg
output = ${buildout:directory}/template-down.cfg
md5sum = ccb8f1d3526db9841304b19917b5b7d3
mode = 0644

[template-apache-php]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-apache-php.cfg
output = ${buildout:directory}/template-apache-php.cfg
md5sum = e2b116cb97c99a19124a07f521d2ac5a
mode = 0644

[template-apache-backup]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-apache-backup.cfg
output = ${buildout:directory}/template-apache-backup.cfg
md5sum = 1f4822930c99c56970913763f406a020
mode = 0644

[template-backuped]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-backuped.cfg
output = ${buildout:directory}/template-backuped.cfg
md5sum = b989e07c047fe9903719257a9d192c23
mode = 0644

[template-mariadb]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-mariadb.cfg
output = ${buildout:directory}/template-mariadb.cfg
md5sum = 70ab558c2e925c3627c39fbc20a7501c
mode = 0644

[template-mariadb-pbsready]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-mariadb-pbsready.cfg
output = ${buildout:directory}/template-mariadb-pbsready.cfg
md5sum = 6f0668043fc3fa79e0a5a263b68589e8
mode = 0644

[template-mariadb-pbsready-import]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-mariadb-pbsready-import.cfg
output = ${buildout:directory}/template-mariadb-pbsready-import.cfg
md5sum = 6042272fecdeee6ddd05c265b64b1152
mode = 0644

[template-mariadb-pbsready-export]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-mariadb-pbsready-export.cfg
output = ${buildout:directory}/template-mariadb-pbsready-export.cfg
md5sum = b4b1f57775bc56bd108c4c3b652e752c
mode = 0644

[template-pull-backup]
recipe = slapos.recipe.template
url = ${:_profile_base_location_}/instance-pull-backup.cfg
output = ${buildout:directory}/template-pull-backup.cfg
md5sum = 5a188d0334ab0b4ac4e64f1390984892
mode = 0644

[eggs]
recipe = zc.recipe.egg
eggs =
  ${gunicorn:eggs}
  ${lxml-python:egg}
  slapos.toolbox
