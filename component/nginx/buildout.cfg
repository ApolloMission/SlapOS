[buildout]
extends =
  ../pcre/buildout.cfg
  ../zlib/buildout.cfg

parts = nginx

[zlib-nginx]
<= zlib
recipe = hexagonit.recipe.download
source-code-location = ${:location}/zlib-1.2.6

[nginx]
recipe = hexagonit.recipe.cmmi
url = http://nginx.org/download/nginx-1.0.14.tar.gz

configure-options=
  --with-ipv6
  --with-zlib=${zlib-nginx:source-code-location}
  --with-ld-opt="-L ${pcre:location}/lib  -Wl,-rpath=${pcre:location}/lib -Wl,-rpath=${zlib-nginx:source-code-location}/lib"
  --with-cc-opt="-I ${pcre:location}/include"

environment =
	PATH=${pkgconfig:location}/bin:%(PATH)s
	PKG_CONFIG_PATH=${openssl:location}/lib/pkgconfig
	CPPFLAGS =-I${libuuid:location}/include
	LDFLAGS =-Wl,-rpath=${zlib-nginx:source-code-location}/lib -Wl,-rpath=${openssl:location}/lib -L${libuuid:location}/lib -Wl,-rpath=${libuuid:location}/lib -Wl,-rpath=${libexpat:location}/lib -Wl,-rpath=${pcre:location}/lib -Wl,-rpath=${sqlite3:location}/lib -Wl,-rpath=${gdbm:location}/lib
