[buildout]
parts =
  wendelin.core


# wendelin.core installed from released egg from pypi
[wendelin.core]
recipe = zc.recipe.egg:custom
egg = wendelin.core


# wendelin.core installed from latest git version
[wendelin.core-dev]
recipe = zc.recipe.egg:develop
setup = ${wendelin.core-repository-submoduleinit:location}


[wendelin.core-repository]
recipe  = slapos.recipe.build:gitclone
repository = https://lab.nexedi.cn/nexedi/wendelin.core.git
# dir is pretty name as top-level -dev recipe
location = ${buildout:parts-directory}/wendelin.core-dev


# TODO add `git clone --recursive` to slapos.recipe.build:gitclone
#      and this way merge this -submoduleinit into -repository part
[wendelin.core-repository-submoduleinit]
recipe = plone.recipe.command
command = cd "${wendelin.core-repository:location}" && git submodule update --init
stop-on-error = true
# propagate location of main repo
location= ${wendelin.core-repository:location}
