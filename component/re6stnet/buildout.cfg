[buildout]
extends =
  ../../stack/slapos.cfg
  ../git/buildout.cfg
  ../babeld/buildout.cfg

develop = 
  re6stnet-repository

parts = 
  babeld
  re6stnet-develop
  re6stnet

[re6stnet-repository]
recipe = slapos.recipe.build:gitclone
repository = http://git.erp5.org/repos/re6stnet.git
branch = master
git-executable = ${git:location}/bin/git

[re6stnet-develop]
recipe = zc.recipe.egg:develop
setup = ${re6stnet-hack:dir}

[re6stnet-hack]
recipe = plone.recipe.command
stop-on-error = true
dir = ${re6stnet-repository:location}
command =
  rm -f "${:dir}/re6stconf.py" && ln -s re6st-conf "${:dir}/re6stconf.py"
  rm -f "${:dir}/re6stregister.py" && ln -s re6st-conf "${:dir}/re6stregister.py"
  rm -f "${:dir}/re6stnet.py" && ln -s re6st-conf "${:dir}/re6stnet.py"

update-command = ${:command}

[re6stnet]
recipe = zc.recipe.egg
eggs =
  ${lxml-python:egg}
  ${python-cffi:egg}
  ${python-cryptography:egg}
  pyOpenSSL
  re6stnet

script =
  re6stnet
  re6st-conf
  re6st-registry

entry-points =
  re6stnet=re6stnet:main
  re6st-conf=re6stconf:main
  re6st-registry=re6stregistry:main
