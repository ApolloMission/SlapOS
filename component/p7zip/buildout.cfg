[buildout]
parts = p7zip

[p7zip]
recipe = slapos.recipe.cmmi
url = http://downloads.sourceforge.net/project/p7zip/p7zip/9.20.1/p7zip_9.20.1_src_all.tar.bz2
md5sum = bd6caaea567dc0d995c990c5cc883c89
location = ${buildout:parts-directory}/${:_buildout_section_name_}
configure-command = true
strip-top-level-dir = True
pre-build =
    sed -i "s#DEST_HOME=.*#DEST_HOME=${:location}#g" "${:location}__compile__/makefile" "${:location}__compile__/install.sh"
    # directories cannot be read-only, or buildout won't be able to uninstall this component.
    sed -i "s#-type d -exec chmod 555#-type d -exec chmod 755#g" "${:location}__compile__/install.sh"
