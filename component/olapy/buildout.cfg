[buildout]
extends =
  ../numpy/buildout.cfg
  ../lxml-python/buildout.cfg
  ../git/buildout.cfg

[olapy-repository]
recipe = slapos.recipe.build:gitclone
repository = https://lab.nexedi.com/nexedi/olapy.git
branch = feat/erp5_integration
git-executable = ${git:location}/bin/git

[olapy-develop]
recipe = zc.recipe.egg:develop
setup = ${olapy-repository:location}
environment = olapy-env
setup-eggs =
  ${numpy:egg}
  ${lxml-python:egg}
  pip

[olapy-data-dir]
recipe = z3c.recipe.mkdir

[olapy-env]
<= numpy-env
OLAPY_PATH = ${olapy-data-dir:paths}

[olapy]
recipe = zc.recipe.egg:custom
egg = olapy
environment = olapy-env
setup-eggs =
  ${numpy:egg}
  ${lxml-python:egg}
  pip
initialization =
  import os
  os.environ['OLAPY_PATH'] = "${olapy-data-dir:paths}"
