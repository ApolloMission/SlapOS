[buildout]
extends =
  ../jupyter-pip/buildout.cfg
parts =
  renderjs_nbextension


# renderjs_nbextension installed from latest git version
[renderjs_nbextension]
recipe = zc.recipe.egg:develop
egg = renderjs_nbextension
setup = ${renderjs_nbextension-submoduleinit:location}/renderjs_nbextension
setup-eggs = ${jupyter-pip:egg}


[renderjs_nbextension-repository]
recipe  = slapos.recipe.build:gitclone
repository = https://lab.nexedi.com/Kreisel/renderjs_extension.git
# dir is pretty name as top-level -dev recipe
location = ${buildout:parts-directory}/renderjs_nbextension
git-executable = /sbin/git


# TODO add `git clone --recursive` to slapos.recipe.build:gitclone
#      and this way merge this -submoduleinit into -repository part
[renderjs_nbextension-submoduleinit]
recipe = plone.recipe.command
command = cd "${renderjs_nbextension-repository:location}" && /sbin/git submodule update --init
stop-on-error = true
# propagate location of main repo
location= ${renderjs_nbextension-repository:location}
